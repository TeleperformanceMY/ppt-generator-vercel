{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 70, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/alameer.8/Downloads/ppt-generator-with-power-automate/app/api/generate-ppt/route.ts"],"sourcesContent":["import { type NextRequest, NextResponse } from \"next/server\"\nimport PptxGenJS from \"pptxgenjs\"\n\n// ============================================\n// TYPE DEFINITIONS\n// ============================================\n\ninterface TitleSlide {\n  type: \"title\"\n  master: \"TP_TITLE\"\n  title: string\n  subtitle?: string\n}\n\ninterface ChapterSlide {\n  type: \"chapter\"\n  master: \"TP_CHAPTER\"\n  chapterNumber: number\n  title: string\n  subtitle?: string\n  chapterImageNumber?: number\n  chapterImageBase64?: string\n}\n\ninterface ContentSlide {\n  type: \"content\"\n  master: \"TP_CONTENT_WHITE\" | \"TP_CONTENT_BEIGE\"\n  title: string\n  headerText?: string\n  content: string\n}\n\ninterface BulletsSlide {\n  type: \"bullets\"\n  master: \"TP_CONTENT_WHITE\" | \"TP_CONTENT_BEIGE\"\n  title: string\n  headerText?: string\n  items: string[]\n}\n\ninterface TwoColumnSlide {\n  type: \"two-column\"\n  master: \"TP_CONTENT_WHITE\" | \"TP_CONTENT_BEIGE\"\n  title: string\n  headerText?: string\n  leftContent: string\n  rightContent: string\n}\n\ninterface ImageSlide {\n  type: \"image\"\n  master: \"TP_CONTENT_WHITE\" | \"TP_CONTENT_BEIGE\"\n  title: string\n  headerText?: string\n  imageBase64: string\n}\n\ntype Slide = TitleSlide | ChapterSlide | ContentSlide | BulletsSlide | TwoColumnSlide | ImageSlide\n\ninterface PresentationRequest {\n  title: string\n  slides: Slide[]\n  apiKey?: string\n}\n\ninterface PresentationResponse {\n  fileName: string\n  fileBase64: string\n}\n\ninterface ErrorResponse {\n  error: string\n  code: string\n  details?: string\n}\n\n// ============================================\n// CONFIGURATION\n// ============================================\n\nconst VALID_API_KEY = process.env.PPT_API_KEY || null\nconst MAX_PAYLOAD_SIZE = 10 * 1024 * 1024\n\n// TP Brand Colors\nconst TP_COLORS = {\n  black: \"000000\",\n  white: \"FFFFFF\",\n  beige: \"D4D1CA\",\n  purple: \"4A4C6A\",\n  purpleLight: \"6B6D8A\",\n  pink: \"ED1E81\",\n  gray: \"666666\",\n  lightGray: \"CCCCCC\",\n}\n\nconst STATIC_ASSET_BASE_URL =\n  process.env.STATIC_ASSET_BASE_URL || process.env.NEXT_PUBLIC_SITE_URL || \"http://localhost:3000\"\nconst LOGO_WHITE_URL = \"/images/gmt-logo-20tp-rgb-feb-202025-white.png\"\nconst LOGO_BLACK_URL = \"/images/gmt-logo-20tp-rgb-feb-202025-black.png\"\n\nconst CHAPTER_IMAGE_BASE_URL = process.env.CHAPTER_IMAGE_BASE_URL || \"\"\n\n// ============================================\n// HELPER FUNCTIONS\n// ============================================\n\nfunction resolveAssetUrl(url: string) {\n  if (url.startsWith(\"http://\") || url.startsWith(\"https://\")) {\n    return url\n  }\n  try {\n    return new URL(url, STATIC_ASSET_BASE_URL).toString()\n  } catch {\n    return url\n  }\n}\n\nasync function fetchImageAsBase64(url: string): Promise<string | null> {\n  try {\n    const response = await fetch(resolveAssetUrl(url))\n    if (!response.ok) return null\n    const arrayBuffer = await response.arrayBuffer()\n    const base64 = Buffer.from(arrayBuffer).toString(\"base64\")\n    const contentType = response.headers.get(\"content-type\") || \"image/png\"\n    return `data:${contentType};base64,${base64}`\n  } catch (error) {\n    console.error(\"Failed to fetch image:\", url, error)\n    return null\n  }\n}\n\nasync function getChapterImageBase64(imageNumber: number): Promise<string | null> {\n  if (!CHAPTER_IMAGE_BASE_URL || imageNumber < 1 || imageNumber > 33) {\n    return null\n  }\n\n  const extensions = [\"png\", \"jpg\", \"jpeg\"]\n  for (const ext of extensions) {\n    const url = `${CHAPTER_IMAGE_BASE_URL}/image${imageNumber}.${ext}`\n    const base64 = await fetchImageAsBase64(url)\n    if (base64) return base64\n  }\n  return null\n}\n\n// ============================================\n// SLIDE MASTER DEFINITIONS\n// ============================================\n\nfunction defineSlideMasters(pptx: PptxGenJS): void {\n  pptx.defineSlideMaster({\n    title: \"TP_TITLE\",\n    background: { color: TP_COLORS.white },\n  })\n\n  pptx.defineSlideMaster({\n    title: \"TP_CHAPTER\",\n    background: { color: TP_COLORS.white },\n  })\n\n  pptx.defineSlideMaster({\n    title: \"TP_CONTENT_WHITE\",\n    background: { color: TP_COLORS.white },\n  })\n\n  pptx.defineSlideMaster({\n    title: \"TP_CONTENT_BEIGE\",\n    background: { color: TP_COLORS.beige },\n  })\n}\n\n// ============================================\n// FOOTER HELPER - Adds consistent footer to content slides\n// ============================================\n\nasync function addContentFooter(\n  pptSlide: PptxGenJS.Slide,\n  presentationTitle: string,\n  slideNumber: number,\n): Promise<void> {\n  pptSlide.addShape(\"line\", {\n    x: 0.3,\n    y: 5.0,\n    w: 9.4,\n    h: 0,\n    line: { color: TP_COLORS.black, width: 0.5 },\n  })\n\n  // Black logo for white/beige backgrounds\n  const logoBase64 = await fetchImageAsBase64(LOGO_BLACK_URL)\n  if (logoBase64) {\n    pptSlide.addImage({\n      data: logoBase64,\n      x: 0.3,\n      y: 5.1,\n      w: 0.2,\n      h: 0.2,\n    })\n  }\n\n  pptSlide.addText(\"tp.com\", {\n    x: 0.55,\n    y: 5.1,\n    w: 0.5,\n    h: 0.2,\n    fontSize: 7,\n    fontFace: \"Calibri\",\n    color: TP_COLORS.black,\n  })\n\n  pptSlide.addText(presentationTitle, {\n    x: 7.0,\n    y: 5.1,\n    w: 2.0,\n    h: 0.2,\n    fontSize: 7,\n    fontFace: \"Calibri\",\n    color: TP_COLORS.black,\n    align: \"right\",\n  })\n\n  // Single vertical line separator\n  pptSlide.addShape(\"line\", {\n    x: 9.1,\n    y: 5.08,\n    w: 0,\n    h: 0.22,\n    line: { color: TP_COLORS.black, width: 0.5 },\n  })\n\n  // Page number\n  pptSlide.addText(slideNumber.toString(), {\n    x: 9.2,\n    y: 5.1,\n    w: 0.4,\n    h: 0.2,\n    fontSize: 7,\n    fontFace: \"Calibri\",\n    color: TP_COLORS.black,\n    align: \"center\",\n  })\n}\n\n// ============================================\n// SLIDE BUILDERS\n// ============================================\n\nasync function addTitleSlide(pptx: PptxGenJS, slide: TitleSlide): Promise<void> {\n  const pptSlide = pptx.addSlide({ masterName: \"TP_TITLE\" })\n\n  // Main title - black text on white background\n  pptSlide.addText(slide.title, {\n    x: 0.5,\n    y: 2.2,\n    w: 9,\n    h: 1.2,\n    fontSize: 44,\n    fontFace: \"Calibri\",\n    color: TP_COLORS.black,\n    bold: true,\n    align: \"left\",\n    valign: \"middle\",\n  })\n\n  // Subtitle - gray text\n  if (slide.subtitle) {\n    pptSlide.addText(slide.subtitle, {\n      x: 0.5,\n      y: 3.4,\n      w: 9,\n      h: 0.8,\n      fontSize: 24,\n      fontFace: \"Calibri Light\",\n      color: TP_COLORS.gray,\n      align: \"left\",\n      valign: \"middle\",\n    })\n  }\n\n  // Black line at bottom\n  pptSlide.addShape(\"line\", {\n    x: 0.3,\n    y: 5.0,\n    w: 9.4,\n    h: 0,\n    line: { color: TP_COLORS.black, width: 0.5 },\n  })\n\n  // Black logo\n  const logoBase64 = await fetchImageAsBase64(LOGO_BLACK_URL)\n  if (logoBase64) {\n    pptSlide.addImage({\n      data: logoBase64,\n      x: 0.3,\n      y: 5.1,\n      w: 0.2,\n      h: 0.2,\n    })\n  }\n\n  pptSlide.addText(\"tp.com\", {\n    x: 0.55,\n    y: 5.1,\n    w: 0.5,\n    h: 0.2,\n    fontSize: 7,\n    fontFace: \"Calibri\",\n    color: TP_COLORS.black,\n  })\n}\n\nasync function addChapterSlide(pptx: PptxGenJS, slide: ChapterSlide): Promise<void> {\n  const pptSlide = pptx.addSlide({ masterName: \"TP_CHAPTER\" })\n\n  // Right purple panel\n  pptSlide.addShape(\"rect\", {\n    x: 5,\n    y: 0,\n    w: 5,\n    h: 5.63,\n    fill: { color: TP_COLORS.purple },\n    line: { color: TP_COLORS.purple },\n  })\n\n  // Left side - chapter image or placeholder\n  let hasImage = false\n  if (slide.chapterImageBase64) {\n    const imageData = slide.chapterImageBase64.includes(\"base64,\")\n      ? slide.chapterImageBase64\n      : `data:image/png;base64,${slide.chapterImageBase64}`\n    pptSlide.addImage({\n      data: imageData,\n      x: 0,\n      y: 0,\n      w: 5,\n      h: 5.63,\n      sizing: { type: \"cover\", w: 5, h: 5.63 },\n    })\n    hasImage = true\n  } else if (slide.chapterImageNumber) {\n    const imageBase64 = await getChapterImageBase64(slide.chapterImageNumber)\n    if (imageBase64) {\n      pptSlide.addImage({\n        data: imageBase64,\n        x: 0,\n        y: 0,\n        w: 5,\n        h: 5.63,\n        sizing: { type: \"cover\", w: 5, h: 5.63 },\n      })\n      hasImage = true\n    }\n  }\n\n  // If no image, add beige placeholder\n  if (!hasImage) {\n    pptSlide.addShape(\"rect\", {\n      x: 0,\n      y: 0,\n      w: 5,\n      h: 5.63,\n      fill: { color: TP_COLORS.beige },\n    })\n  }\n\n  // White logo top-right\n  const logoBase64 = await fetchImageAsBase64(LOGO_WHITE_URL)\n  if (logoBase64) {\n    pptSlide.addImage({\n      data: logoBase64,\n      x: 9.2,\n      y: 0.3,\n      w: 0.4,\n      h: 0.4,\n    })\n  }\n\n  // Chapter number\n  const formattedNumber = slide.chapterNumber.toString().padStart(2, \"0\")\n  pptSlide.addText(formattedNumber, {\n    x: 5.3,\n    y: 0.8,\n    w: 4.2,\n    h: 1.5,\n    fontSize: 72,\n    fontFace: \"Calibri Light\",\n    color: TP_COLORS.purpleLight,\n    align: \"right\",\n  })\n\n  // Dashed border around title\n  pptSlide.addShape(\"rect\", {\n    x: 5.5,\n    y: 2.5,\n    w: 4,\n    h: 1.2,\n    fill: { type: \"none\" },\n    line: { color: TP_COLORS.white, width: 1, dashType: \"dash\" },\n  })\n\n  // Title text\n  pptSlide.addText(slide.title, {\n    x: 5.6,\n    y: 2.6,\n    w: 3.8,\n    h: 1,\n    fontSize: 24,\n    fontFace: \"Calibri\",\n    color: TP_COLORS.white,\n    align: \"center\",\n    valign: \"middle\",\n    italic: true,\n  })\n\n  // Subtitle with line above\n  if (slide.subtitle) {\n    pptSlide.addShape(\"line\", {\n      x: 5.5,\n      y: 4.0,\n      w: 4,\n      h: 0,\n      line: { color: TP_COLORS.white, width: 0.5 },\n    })\n\n    pptSlide.addText(slide.subtitle, {\n      x: 5.5,\n      y: 4.1,\n      w: 4,\n      h: 0.5,\n      fontSize: 14,\n      fontFace: \"Calibri\",\n      color: TP_COLORS.white,\n      align: \"center\",\n    })\n  }\n\n  // Pink bar at bottom\n  pptSlide.addShape(\"rect\", {\n    x: 5,\n    y: 5.43,\n    w: 5,\n    h: 0.2,\n    fill: { color: TP_COLORS.pink },\n    line: { color: TP_COLORS.pink },\n  })\n}\n\nasync function addContentSlide(\n  pptx: PptxGenJS,\n  slide: ContentSlide,\n  presentationTitle: string,\n  slideNumber: number,\n): Promise<void> {\n  const pptSlide = pptx.addSlide({ masterName: slide.master })\n\n  let yOffset = 0.3\n\n  if (slide.headerText) {\n    pptSlide.addText(slide.headerText, {\n      x: 0.5,\n      y: yOffset,\n      w: 9,\n      h: 0.3,\n      fontSize: 12,\n      fontFace: \"Calibri\",\n      color: TP_COLORS.pink,\n    })\n    yOffset += 0.35\n  }\n\n  pptSlide.addText(slide.title, {\n    x: 0.5,\n    y: yOffset,\n    w: 9,\n    h: 0.7,\n    fontSize: 32,\n    fontFace: \"Calibri\",\n    color: TP_COLORS.black,\n    bold: true,\n  })\n\n  pptSlide.addText(slide.content, {\n    x: 0.5,\n    y: yOffset + 0.9,\n    w: 9,\n    h: 3.2,\n    fontSize: 16,\n    fontFace: \"Calibri Light\",\n    color: TP_COLORS.black,\n    valign: \"top\",\n    paraSpaceAfter: 12,\n  })\n\n  await addContentFooter(pptSlide, presentationTitle, slideNumber)\n}\n\nasync function addBulletsSlide(\n  pptx: PptxGenJS,\n  slide: BulletsSlide,\n  presentationTitle: string,\n  slideNumber: number,\n): Promise<void> {\n  const pptSlide = pptx.addSlide({ masterName: slide.master })\n\n  let yOffset = 0.3\n\n  if (slide.headerText) {\n    pptSlide.addText(slide.headerText, {\n      x: 0.5,\n      y: yOffset,\n      w: 9,\n      h: 0.3,\n      fontSize: 12,\n      fontFace: \"Calibri\",\n      color: TP_COLORS.pink,\n    })\n    yOffset += 0.35\n  }\n\n  pptSlide.addText(slide.title, {\n    x: 0.5,\n    y: yOffset,\n    w: 9,\n    h: 0.7,\n    fontSize: 32,\n    fontFace: \"Calibri\",\n    color: TP_COLORS.black,\n    bold: true,\n  })\n\n  const bulletItems = slide.items.map((item) => ({\n    text: item,\n    options: {\n      bullet: { type: \"bullet\" as const, color: TP_COLORS.pink },\n      paraSpaceBefore: 8,\n      paraSpaceAfter: 8,\n    },\n  }))\n\n  pptSlide.addText(bulletItems, {\n    x: 0.5,\n    y: yOffset + 0.9,\n    w: 9,\n    h: 3.2,\n    fontSize: 18,\n    fontFace: \"Calibri Light\",\n    color: TP_COLORS.black,\n    valign: \"top\",\n  })\n\n  await addContentFooter(pptSlide, presentationTitle, slideNumber)\n}\n\nasync function addTwoColumnSlide(\n  pptx: PptxGenJS,\n  slide: TwoColumnSlide,\n  presentationTitle: string,\n  slideNumber: number,\n): Promise<void> {\n  const pptSlide = pptx.addSlide({ masterName: slide.master })\n\n  let yOffset = 0.3\n\n  if (slide.headerText) {\n    pptSlide.addText(slide.headerText, {\n      x: 0.5,\n      y: yOffset,\n      w: 9,\n      h: 0.3,\n      fontSize: 12,\n      fontFace: \"Calibri\",\n      color: TP_COLORS.pink,\n    })\n    yOffset += 0.35\n  }\n\n  pptSlide.addText(slide.title, {\n    x: 0.5,\n    y: yOffset,\n    w: 9,\n    h: 0.7,\n    fontSize: 32,\n    fontFace: \"Calibri\",\n    color: TP_COLORS.black,\n    bold: true,\n  })\n\n  pptSlide.addText(slide.leftContent, {\n    x: 0.5,\n    y: yOffset + 0.9,\n    w: 4.3,\n    h: 3.2,\n    fontSize: 16,\n    fontFace: \"Calibri Light\",\n    color: TP_COLORS.black,\n    valign: \"top\",\n  })\n\n  pptSlide.addText(slide.rightContent, {\n    x: 5.2,\n    y: yOffset + 0.9,\n    w: 4.3,\n    h: 3.2,\n    fontSize: 16,\n    fontFace: \"Calibri Light\",\n    color: TP_COLORS.black,\n    valign: \"top\",\n  })\n\n  await addContentFooter(pptSlide, presentationTitle, slideNumber)\n}\n\nasync function addImageSlide(\n  pptx: PptxGenJS,\n  slide: ImageSlide,\n  presentationTitle: string,\n  slideNumber: number,\n): Promise<void> {\n  const pptSlide = pptx.addSlide({ masterName: slide.master })\n\n  let yOffset = 0.3\n\n  if (slide.headerText) {\n    pptSlide.addText(slide.headerText, {\n      x: 0.5,\n      y: yOffset,\n      w: 9,\n      h: 0.3,\n      fontSize: 12,\n      fontFace: \"Calibri\",\n      color: TP_COLORS.pink,\n    })\n    yOffset += 0.35\n  }\n\n  pptSlide.addText(slide.title, {\n    x: 0.5,\n    y: yOffset,\n    w: 9,\n    h: 0.7,\n    fontSize: 32,\n    fontFace: \"Calibri\",\n    color: TP_COLORS.black,\n    bold: true,\n  })\n\n  const imageData = slide.imageBase64.includes(\"base64,\")\n    ? slide.imageBase64\n    : `data:image/png;base64,${slide.imageBase64}`\n\n  pptSlide.addImage({\n    data: imageData,\n    x: 1,\n    y: yOffset + 0.9,\n    w: 8,\n    h: 3.2,\n    sizing: { type: \"contain\", w: 8, h: 3.2 },\n  })\n\n  await addContentFooter(pptSlide, presentationTitle, slideNumber)\n}\n\n// ============================================\n// VALIDATION\n// ============================================\n\nfunction validateRequest(\n  data: unknown,\n): { valid: true; data: PresentationRequest } | { valid: false; error: ErrorResponse } {\n  if (!data || typeof data !== \"object\") {\n    return {\n      valid: false,\n      error: {\n        error: \"Invalid request body\",\n        code: \"INVALID_BODY\",\n        details: \"Request body must be a valid JSON object\",\n      },\n    }\n  }\n\n  const req = data as Record<string, unknown>\n\n  if (!req.title || typeof req.title !== \"string\") {\n    return {\n      valid: false,\n      error: {\n        error: \"Missing or invalid title\",\n        code: \"INVALID_TITLE\",\n        details: \"The 'title' field must be a non-empty string\",\n      },\n    }\n  }\n\n  if (!Array.isArray(req.slides) || req.slides.length === 0) {\n    return {\n      valid: false,\n      error: {\n        error: \"Missing or invalid slides\",\n        code: \"INVALID_SLIDES\",\n        details: \"The 'slides' field must be a non-empty array\",\n      },\n    }\n  }\n\n  const validTypes = [\"title\", \"chapter\", \"content\", \"bullets\", \"two-column\", \"image\"]\n  const validMasters = [\"TP_TITLE\", \"TP_CHAPTER\", \"TP_CONTENT_WHITE\", \"TP_CONTENT_BEIGE\"]\n\n  for (let i = 0; i < req.slides.length; i++) {\n    const slide = req.slides[i] as Record<string, unknown>\n\n    if (!slide.type || !validTypes.includes(slide.type as string)) {\n      return {\n        valid: false,\n        error: {\n          error: `Invalid slide type at index ${i}`,\n          code: \"INVALID_SLIDE_TYPE\",\n          details: `Slide type must be one of: ${validTypes.join(\", \")}`,\n        },\n      }\n    }\n\n    if (!slide.master || !validMasters.includes(slide.master as string)) {\n      return {\n        valid: false,\n        error: {\n          error: `Invalid master at index ${i}`,\n          code: \"INVALID_MASTER\",\n          details: `Master must be one of: ${validMasters.join(\", \")}`,\n        },\n      }\n    }\n\n    if (!slide.title || typeof slide.title !== \"string\") {\n      return {\n        valid: false,\n        error: {\n          error: `Missing title in slide at index ${i}`,\n          code: \"MISSING_SLIDE_TITLE\",\n        },\n      }\n    }\n\n    if (slide.type === \"content\" && typeof slide.content !== \"string\") {\n      return {\n        valid: false,\n        error: {\n          error: `Missing content in content slide at index ${i}`,\n          code: \"MISSING_CONTENT\",\n        },\n      }\n    }\n\n    if (slide.type === \"bullets\" && !Array.isArray(slide.items)) {\n      return {\n        valid: false,\n        error: {\n          error: `Missing items array in bullets slide at index ${i}`,\n          code: \"MISSING_ITEMS\",\n        },\n      }\n    }\n\n    if (slide.type === \"chapter\" && typeof slide.chapterNumber !== \"number\") {\n      return {\n        valid: false,\n        error: {\n          error: `Missing chapterNumber in chapter slide at index ${i}`,\n          code: \"MISSING_CHAPTER_NUMBER\",\n        },\n      }\n    }\n\n    if (slide.type === \"two-column\") {\n      if (typeof slide.leftContent !== \"string\" || typeof slide.rightContent !== \"string\") {\n        return {\n          valid: false,\n          error: {\n            error: `Missing leftContent or rightContent in two-column slide at index ${i}`,\n            code: \"MISSING_COLUMN_CONTENT\",\n          },\n        }\n      }\n    }\n\n    if (slide.type === \"image\" && typeof slide.imageBase64 !== \"string\") {\n      return {\n        valid: false,\n        error: {\n          error: `Missing imageBase64 in image slide at index ${i}`,\n          code: \"MISSING_IMAGE\",\n        },\n      }\n    }\n  }\n\n  return { valid: true, data: req as unknown as PresentationRequest }\n}\n\n// ============================================\n// MAIN API HANDLER\n// ============================================\n\nexport async function POST(request: NextRequest): Promise<NextResponse<PresentationResponse | ErrorResponse>> {\n  try {\n    const contentLength = request.headers.get(\"content-length\")\n    if (contentLength && Number.parseInt(contentLength) > MAX_PAYLOAD_SIZE) {\n      return NextResponse.json(\n        {\n          error: \"Payload too large\",\n          code: \"PAYLOAD_TOO_LARGE\",\n          details: `Maximum payload size is ${MAX_PAYLOAD_SIZE / 1024 / 1024}MB`,\n        },\n        { status: 413 },\n      )\n    }\n\n    let body: unknown\n    try {\n      body = await request.json()\n    } catch {\n      return NextResponse.json(\n        {\n          error: \"Invalid JSON\",\n          code: \"INVALID_JSON\",\n          details: \"Request body must be valid JSON\",\n        },\n        { status: 400 },\n      )\n    }\n\n    if (VALID_API_KEY) {\n      const apiKey = (body as Record<string, unknown>)?.apiKey || request.headers.get(\"x-api-key\")\n      if (apiKey !== VALID_API_KEY) {\n        return NextResponse.json(\n          {\n            error: \"Unauthorized\",\n            code: \"UNAUTHORIZED\",\n            details: \"Invalid or missing API key\",\n          },\n          { status: 401 },\n        )\n      }\n    }\n\n    const validation = validateRequest(body)\n    if (!validation.valid) {\n      return NextResponse.json(validation.error, { status: 400 })\n    }\n\n    const { title, slides } = validation.data\n\n    const pptx = new PptxGenJS()\n    pptx.title = title\n    pptx.author = \"TP PPT Generator\"\n    pptx.company = \"Teleperformance\"\n    pptx.layout = \"LAYOUT_16x9\"\n\n    defineSlideMasters(pptx)\n\n    let slideNumber = 1\n    for (const slide of slides) {\n      switch (slide.type) {\n        case \"title\":\n          await addTitleSlide(pptx, slide)\n          break\n        case \"chapter\":\n          await addChapterSlide(pptx, slide)\n          break\n        case \"content\":\n          await addContentSlide(pptx, slide, title, slideNumber)\n          break\n        case \"bullets\":\n          await addBulletsSlide(pptx, slide, title, slideNumber)\n          break\n        case \"two-column\":\n          await addTwoColumnSlide(pptx, slide, title, slideNumber)\n          break\n        case \"image\":\n          await addImageSlide(pptx, slide, title, slideNumber)\n          break\n      }\n      slideNumber++\n    }\n\n    const base64Data = await pptx.write({ outputType: \"base64\" })\n    const safeTitle = title.replace(/[^a-zA-Z0-9]/g, \"_\").substring(0, 50)\n    const fileName = `${safeTitle}_${Date.now()}.pptx`\n\n    return NextResponse.json({\n      fileName,\n      fileBase64: base64Data as string,\n    })\n  } catch (error) {\n    console.error(\"PPT Generation Error:\", error)\n    return NextResponse.json(\n      {\n        error: \"Internal server error\",\n        code: \"INTERNAL_ERROR\",\n        details: error instanceof Error ? error.message : \"Unknown error occurred\",\n      },\n      { status: 500 },\n    )\n  }\n}\n"],"names":[],"mappings":";;;;AAAA;AACA;;;AA2EA,+CAA+C;AAC/C,gBAAgB;AAChB,+CAA+C;AAE/C,MAAM,gBAAgB,QAAQ,GAAG,CAAC,WAAW,IAAI;AACjD,MAAM,mBAAmB,KAAK,OAAO;AAErC,kBAAkB;AAClB,MAAM,YAAY;IAChB,OAAO;IACP,OAAO;IACP,OAAO;IACP,QAAQ;IACR,aAAa;IACb,MAAM;IACN,MAAM;IACN,WAAW;AACb;AAEA,MAAM,wBACJ,QAAQ,GAAG,CAAC,qBAAqB,IAAI,QAAQ,GAAG,CAAC,oBAAoB,IAAI;AAC3E,MAAM,iBAAiB;AACvB,MAAM,iBAAiB;AAEvB,MAAM,yBAAyB,QAAQ,GAAG,CAAC,sBAAsB,IAAI;AAErE,+CAA+C;AAC/C,mBAAmB;AACnB,+CAA+C;AAE/C,SAAS,gBAAgB,GAAW;IAClC,IAAI,IAAI,UAAU,CAAC,cAAc,IAAI,UAAU,CAAC,aAAa;QAC3D,OAAO;IACT;IACA,IAAI;QACF,OAAO,IAAI,IAAI,KAAK,uBAAuB,QAAQ;IACrD,EAAE,OAAM;QACN,OAAO;IACT;AACF;AAEA,eAAe,mBAAmB,GAAW;IAC3C,IAAI;QACF,MAAM,WAAW,MAAM,MAAM,gBAAgB;QAC7C,IAAI,CAAC,SAAS,EAAE,EAAE,OAAO;QACzB,MAAM,cAAc,MAAM,SAAS,WAAW;QAC9C,MAAM,SAAS,OAAO,IAAI,CAAC,aAAa,QAAQ,CAAC;QACjD,MAAM,cAAc,SAAS,OAAO,CAAC,GAAG,CAAC,mBAAmB;QAC5D,OAAO,CAAC,KAAK,EAAE,YAAY,QAAQ,EAAE,QAAQ;IAC/C,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,0BAA0B,KAAK;QAC7C,OAAO;IACT;AACF;AAEA,eAAe,sBAAsB,WAAmB;IACtD,IAAI,CAAC,0BAA0B,cAAc,KAAK,cAAc,IAAI;QAClE,OAAO;IACT;IAEA,MAAM,aAAa;QAAC;QAAO;QAAO;KAAO;IACzC,KAAK,MAAM,OAAO,WAAY;QAC5B,MAAM,MAAM,GAAG,uBAAuB,MAAM,EAAE,YAAY,CAAC,EAAE,KAAK;QAClE,MAAM,SAAS,MAAM,mBAAmB;QACxC,IAAI,QAAQ,OAAO;IACrB;IACA,OAAO;AACT;AAEA,+CAA+C;AAC/C,2BAA2B;AAC3B,+CAA+C;AAE/C,SAAS,mBAAmB,IAAe;IACzC,KAAK,iBAAiB,CAAC;QACrB,OAAO;QACP,YAAY;YAAE,OAAO,UAAU,KAAK;QAAC;IACvC;IAEA,KAAK,iBAAiB,CAAC;QACrB,OAAO;QACP,YAAY;YAAE,OAAO,UAAU,KAAK;QAAC;IACvC;IAEA,KAAK,iBAAiB,CAAC;QACrB,OAAO;QACP,YAAY;YAAE,OAAO,UAAU,KAAK;QAAC;IACvC;IAEA,KAAK,iBAAiB,CAAC;QACrB,OAAO;QACP,YAAY;YAAE,OAAO,UAAU,KAAK;QAAC;IACvC;AACF;AAEA,+CAA+C;AAC/C,2DAA2D;AAC3D,+CAA+C;AAE/C,eAAe,iBACb,QAAyB,EACzB,iBAAyB,EACzB,WAAmB;IAEnB,SAAS,QAAQ,CAAC,QAAQ;QACxB,GAAG;QACH,GAAG;QACH,GAAG;QACH,GAAG;QACH,MAAM;YAAE,OAAO,UAAU,KAAK;YAAE,OAAO;QAAI;IAC7C;IAEA,yCAAyC;IACzC,MAAM,aAAa,MAAM,mBAAmB;IAC5C,IAAI,YAAY;QACd,SAAS,QAAQ,CAAC;YAChB,MAAM;YACN,GAAG;YACH,GAAG;YACH,GAAG;YACH,GAAG;QACL;IACF;IAEA,SAAS,OAAO,CAAC,UAAU;QACzB,GAAG;QACH,GAAG;QACH,GAAG;QACH,GAAG;QACH,UAAU;QACV,UAAU;QACV,OAAO,UAAU,KAAK;IACxB;IAEA,SAAS,OAAO,CAAC,mBAAmB;QAClC,GAAG;QACH,GAAG;QACH,GAAG;QACH,GAAG;QACH,UAAU;QACV,UAAU;QACV,OAAO,UAAU,KAAK;QACtB,OAAO;IACT;IAEA,iCAAiC;IACjC,SAAS,QAAQ,CAAC,QAAQ;QACxB,GAAG;QACH,GAAG;QACH,GAAG;QACH,GAAG;QACH,MAAM;YAAE,OAAO,UAAU,KAAK;YAAE,OAAO;QAAI;IAC7C;IAEA,cAAc;IACd,SAAS,OAAO,CAAC,YAAY,QAAQ,IAAI;QACvC,GAAG;QACH,GAAG;QACH,GAAG;QACH,GAAG;QACH,UAAU;QACV,UAAU;QACV,OAAO,UAAU,KAAK;QACtB,OAAO;IACT;AACF;AAEA,+CAA+C;AAC/C,iBAAiB;AACjB,+CAA+C;AAE/C,eAAe,cAAc,IAAe,EAAE,KAAiB;IAC7D,MAAM,WAAW,KAAK,QAAQ,CAAC;QAAE,YAAY;IAAW;IAExD,8CAA8C;IAC9C,SAAS,OAAO,CAAC,MAAM,KAAK,EAAE;QAC5B,GAAG;QACH,GAAG;QACH,GAAG;QACH,GAAG;QACH,UAAU;QACV,UAAU;QACV,OAAO,UAAU,KAAK;QACtB,MAAM;QACN,OAAO;QACP,QAAQ;IACV;IAEA,uBAAuB;IACvB,IAAI,MAAM,QAAQ,EAAE;QAClB,SAAS,OAAO,CAAC,MAAM,QAAQ,EAAE;YAC/B,GAAG;YACH,GAAG;YACH,GAAG;YACH,GAAG;YACH,UAAU;YACV,UAAU;YACV,OAAO,UAAU,IAAI;YACrB,OAAO;YACP,QAAQ;QACV;IACF;IAEA,uBAAuB;IACvB,SAAS,QAAQ,CAAC,QAAQ;QACxB,GAAG;QACH,GAAG;QACH,GAAG;QACH,GAAG;QACH,MAAM;YAAE,OAAO,UAAU,KAAK;YAAE,OAAO;QAAI;IAC7C;IAEA,aAAa;IACb,MAAM,aAAa,MAAM,mBAAmB;IAC5C,IAAI,YAAY;QACd,SAAS,QAAQ,CAAC;YAChB,MAAM;YACN,GAAG;YACH,GAAG;YACH,GAAG;YACH,GAAG;QACL;IACF;IAEA,SAAS,OAAO,CAAC,UAAU;QACzB,GAAG;QACH,GAAG;QACH,GAAG;QACH,GAAG;QACH,UAAU;QACV,UAAU;QACV,OAAO,UAAU,KAAK;IACxB;AACF;AAEA,eAAe,gBAAgB,IAAe,EAAE,KAAmB;IACjE,MAAM,WAAW,KAAK,QAAQ,CAAC;QAAE,YAAY;IAAa;IAE1D,qBAAqB;IACrB,SAAS,QAAQ,CAAC,QAAQ;QACxB,GAAG;QACH,GAAG;QACH,GAAG;QACH,GAAG;QACH,MAAM;YAAE,OAAO,UAAU,MAAM;QAAC;QAChC,MAAM;YAAE,OAAO,UAAU,MAAM;QAAC;IAClC;IAEA,2CAA2C;IAC3C,IAAI,WAAW;IACf,IAAI,MAAM,kBAAkB,EAAE;QAC5B,MAAM,YAAY,MAAM,kBAAkB,CAAC,QAAQ,CAAC,aAChD,MAAM,kBAAkB,GACxB,CAAC,sBAAsB,EAAE,MAAM,kBAAkB,EAAE;QACvD,SAAS,QAAQ,CAAC;YAChB,MAAM;YACN,GAAG;YACH,GAAG;YACH,GAAG;YACH,GAAG;YACH,QAAQ;gBAAE,MAAM;gBAAS,GAAG;gBAAG,GAAG;YAAK;QACzC;QACA,WAAW;IACb,OAAO,IAAI,MAAM,kBAAkB,EAAE;QACnC,MAAM,cAAc,MAAM,sBAAsB,MAAM,kBAAkB;QACxE,IAAI,aAAa;YACf,SAAS,QAAQ,CAAC;gBAChB,MAAM;gBACN,GAAG;gBACH,GAAG;gBACH,GAAG;gBACH,GAAG;gBACH,QAAQ;oBAAE,MAAM;oBAAS,GAAG;oBAAG,GAAG;gBAAK;YACzC;YACA,WAAW;QACb;IACF;IAEA,qCAAqC;IACrC,IAAI,CAAC,UAAU;QACb,SAAS,QAAQ,CAAC,QAAQ;YACxB,GAAG;YACH,GAAG;YACH,GAAG;YACH,GAAG;YACH,MAAM;gBAAE,OAAO,UAAU,KAAK;YAAC;QACjC;IACF;IAEA,uBAAuB;IACvB,MAAM,aAAa,MAAM,mBAAmB;IAC5C,IAAI,YAAY;QACd,SAAS,QAAQ,CAAC;YAChB,MAAM;YACN,GAAG;YACH,GAAG;YACH,GAAG;YACH,GAAG;QACL;IACF;IAEA,iBAAiB;IACjB,MAAM,kBAAkB,MAAM,aAAa,CAAC,QAAQ,GAAG,QAAQ,CAAC,GAAG;IACnE,SAAS,OAAO,CAAC,iBAAiB;QAChC,GAAG;QACH,GAAG;QACH,GAAG;QACH,GAAG;QACH,UAAU;QACV,UAAU;QACV,OAAO,UAAU,WAAW;QAC5B,OAAO;IACT;IAEA,6BAA6B;IAC7B,SAAS,QAAQ,CAAC,QAAQ;QACxB,GAAG;QACH,GAAG;QACH,GAAG;QACH,GAAG;QACH,MAAM;YAAE,MAAM;QAAO;QACrB,MAAM;YAAE,OAAO,UAAU,KAAK;YAAE,OAAO;YAAG,UAAU;QAAO;IAC7D;IAEA,aAAa;IACb,SAAS,OAAO,CAAC,MAAM,KAAK,EAAE;QAC5B,GAAG;QACH,GAAG;QACH,GAAG;QACH,GAAG;QACH,UAAU;QACV,UAAU;QACV,OAAO,UAAU,KAAK;QACtB,OAAO;QACP,QAAQ;QACR,QAAQ;IACV;IAEA,2BAA2B;IAC3B,IAAI,MAAM,QAAQ,EAAE;QAClB,SAAS,QAAQ,CAAC,QAAQ;YACxB,GAAG;YACH,GAAG;YACH,GAAG;YACH,GAAG;YACH,MAAM;gBAAE,OAAO,UAAU,KAAK;gBAAE,OAAO;YAAI;QAC7C;QAEA,SAAS,OAAO,CAAC,MAAM,QAAQ,EAAE;YAC/B,GAAG;YACH,GAAG;YACH,GAAG;YACH,GAAG;YACH,UAAU;YACV,UAAU;YACV,OAAO,UAAU,KAAK;YACtB,OAAO;QACT;IACF;IAEA,qBAAqB;IACrB,SAAS,QAAQ,CAAC,QAAQ;QACxB,GAAG;QACH,GAAG;QACH,GAAG;QACH,GAAG;QACH,MAAM;YAAE,OAAO,UAAU,IAAI;QAAC;QAC9B,MAAM;YAAE,OAAO,UAAU,IAAI;QAAC;IAChC;AACF;AAEA,eAAe,gBACb,IAAe,EACf,KAAmB,EACnB,iBAAyB,EACzB,WAAmB;IAEnB,MAAM,WAAW,KAAK,QAAQ,CAAC;QAAE,YAAY,MAAM,MAAM;IAAC;IAE1D,IAAI,UAAU;IAEd,IAAI,MAAM,UAAU,EAAE;QACpB,SAAS,OAAO,CAAC,MAAM,UAAU,EAAE;YACjC,GAAG;YACH,GAAG;YACH,GAAG;YACH,GAAG;YACH,UAAU;YACV,UAAU;YACV,OAAO,UAAU,IAAI;QACvB;QACA,WAAW;IACb;IAEA,SAAS,OAAO,CAAC,MAAM,KAAK,EAAE;QAC5B,GAAG;QACH,GAAG;QACH,GAAG;QACH,GAAG;QACH,UAAU;QACV,UAAU;QACV,OAAO,UAAU,KAAK;QACtB,MAAM;IACR;IAEA,SAAS,OAAO,CAAC,MAAM,OAAO,EAAE;QAC9B,GAAG;QACH,GAAG,UAAU;QACb,GAAG;QACH,GAAG;QACH,UAAU;QACV,UAAU;QACV,OAAO,UAAU,KAAK;QACtB,QAAQ;QACR,gBAAgB;IAClB;IAEA,MAAM,iBAAiB,UAAU,mBAAmB;AACtD;AAEA,eAAe,gBACb,IAAe,EACf,KAAmB,EACnB,iBAAyB,EACzB,WAAmB;IAEnB,MAAM,WAAW,KAAK,QAAQ,CAAC;QAAE,YAAY,MAAM,MAAM;IAAC;IAE1D,IAAI,UAAU;IAEd,IAAI,MAAM,UAAU,EAAE;QACpB,SAAS,OAAO,CAAC,MAAM,UAAU,EAAE;YACjC,GAAG;YACH,GAAG;YACH,GAAG;YACH,GAAG;YACH,UAAU;YACV,UAAU;YACV,OAAO,UAAU,IAAI;QACvB;QACA,WAAW;IACb;IAEA,SAAS,OAAO,CAAC,MAAM,KAAK,EAAE;QAC5B,GAAG;QACH,GAAG;QACH,GAAG;QACH,GAAG;QACH,UAAU;QACV,UAAU;QACV,OAAO,UAAU,KAAK;QACtB,MAAM;IACR;IAEA,MAAM,cAAc,MAAM,KAAK,CAAC,GAAG,CAAC,CAAC,OAAS,CAAC;YAC7C,MAAM;YACN,SAAS;gBACP,QAAQ;oBAAE,MAAM;oBAAmB,OAAO,UAAU,IAAI;gBAAC;gBACzD,iBAAiB;gBACjB,gBAAgB;YAClB;QACF,CAAC;IAED,SAAS,OAAO,CAAC,aAAa;QAC5B,GAAG;QACH,GAAG,UAAU;QACb,GAAG;QACH,GAAG;QACH,UAAU;QACV,UAAU;QACV,OAAO,UAAU,KAAK;QACtB,QAAQ;IACV;IAEA,MAAM,iBAAiB,UAAU,mBAAmB;AACtD;AAEA,eAAe,kBACb,IAAe,EACf,KAAqB,EACrB,iBAAyB,EACzB,WAAmB;IAEnB,MAAM,WAAW,KAAK,QAAQ,CAAC;QAAE,YAAY,MAAM,MAAM;IAAC;IAE1D,IAAI,UAAU;IAEd,IAAI,MAAM,UAAU,EAAE;QACpB,SAAS,OAAO,CAAC,MAAM,UAAU,EAAE;YACjC,GAAG;YACH,GAAG;YACH,GAAG;YACH,GAAG;YACH,UAAU;YACV,UAAU;YACV,OAAO,UAAU,IAAI;QACvB;QACA,WAAW;IACb;IAEA,SAAS,OAAO,CAAC,MAAM,KAAK,EAAE;QAC5B,GAAG;QACH,GAAG;QACH,GAAG;QACH,GAAG;QACH,UAAU;QACV,UAAU;QACV,OAAO,UAAU,KAAK;QACtB,MAAM;IACR;IAEA,SAAS,OAAO,CAAC,MAAM,WAAW,EAAE;QAClC,GAAG;QACH,GAAG,UAAU;QACb,GAAG;QACH,GAAG;QACH,UAAU;QACV,UAAU;QACV,OAAO,UAAU,KAAK;QACtB,QAAQ;IACV;IAEA,SAAS,OAAO,CAAC,MAAM,YAAY,EAAE;QACnC,GAAG;QACH,GAAG,UAAU;QACb,GAAG;QACH,GAAG;QACH,UAAU;QACV,UAAU;QACV,OAAO,UAAU,KAAK;QACtB,QAAQ;IACV;IAEA,MAAM,iBAAiB,UAAU,mBAAmB;AACtD;AAEA,eAAe,cACb,IAAe,EACf,KAAiB,EACjB,iBAAyB,EACzB,WAAmB;IAEnB,MAAM,WAAW,KAAK,QAAQ,CAAC;QAAE,YAAY,MAAM,MAAM;IAAC;IAE1D,IAAI,UAAU;IAEd,IAAI,MAAM,UAAU,EAAE;QACpB,SAAS,OAAO,CAAC,MAAM,UAAU,EAAE;YACjC,GAAG;YACH,GAAG;YACH,GAAG;YACH,GAAG;YACH,UAAU;YACV,UAAU;YACV,OAAO,UAAU,IAAI;QACvB;QACA,WAAW;IACb;IAEA,SAAS,OAAO,CAAC,MAAM,KAAK,EAAE;QAC5B,GAAG;QACH,GAAG;QACH,GAAG;QACH,GAAG;QACH,UAAU;QACV,UAAU;QACV,OAAO,UAAU,KAAK;QACtB,MAAM;IACR;IAEA,MAAM,YAAY,MAAM,WAAW,CAAC,QAAQ,CAAC,aACzC,MAAM,WAAW,GACjB,CAAC,sBAAsB,EAAE,MAAM,WAAW,EAAE;IAEhD,SAAS,QAAQ,CAAC;QAChB,MAAM;QACN,GAAG;QACH,GAAG,UAAU;QACb,GAAG;QACH,GAAG;QACH,QAAQ;YAAE,MAAM;YAAW,GAAG;YAAG,GAAG;QAAI;IAC1C;IAEA,MAAM,iBAAiB,UAAU,mBAAmB;AACtD;AAEA,+CAA+C;AAC/C,aAAa;AACb,+CAA+C;AAE/C,SAAS,gBACP,IAAa;IAEb,IAAI,CAAC,QAAQ,OAAO,SAAS,UAAU;QACrC,OAAO;YACL,OAAO;YACP,OAAO;gBACL,OAAO;gBACP,MAAM;gBACN,SAAS;YACX;QACF;IACF;IAEA,MAAM,MAAM;IAEZ,IAAI,CAAC,IAAI,KAAK,IAAI,OAAO,IAAI,KAAK,KAAK,UAAU;QAC/C,OAAO;YACL,OAAO;YACP,OAAO;gBACL,OAAO;gBACP,MAAM;gBACN,SAAS;YACX;QACF;IACF;IAEA,IAAI,CAAC,MAAM,OAAO,CAAC,IAAI,MAAM,KAAK,IAAI,MAAM,CAAC,MAAM,KAAK,GAAG;QACzD,OAAO;YACL,OAAO;YACP,OAAO;gBACL,OAAO;gBACP,MAAM;gBACN,SAAS;YACX;QACF;IACF;IAEA,MAAM,aAAa;QAAC;QAAS;QAAW;QAAW;QAAW;QAAc;KAAQ;IACpF,MAAM,eAAe;QAAC;QAAY;QAAc;QAAoB;KAAmB;IAEvF,IAAK,IAAI,IAAI,GAAG,IAAI,IAAI,MAAM,CAAC,MAAM,EAAE,IAAK;QAC1C,MAAM,QAAQ,IAAI,MAAM,CAAC,EAAE;QAE3B,IAAI,CAAC,MAAM,IAAI,IAAI,CAAC,WAAW,QAAQ,CAAC,MAAM,IAAI,GAAa;YAC7D,OAAO;gBACL,OAAO;gBACP,OAAO;oBACL,OAAO,CAAC,4BAA4B,EAAE,GAAG;oBACzC,MAAM;oBACN,SAAS,CAAC,2BAA2B,EAAE,WAAW,IAAI,CAAC,OAAO;gBAChE;YACF;QACF;QAEA,IAAI,CAAC,MAAM,MAAM,IAAI,CAAC,aAAa,QAAQ,CAAC,MAAM,MAAM,GAAa;YACnE,OAAO;gBACL,OAAO;gBACP,OAAO;oBACL,OAAO,CAAC,wBAAwB,EAAE,GAAG;oBACrC,MAAM;oBACN,SAAS,CAAC,uBAAuB,EAAE,aAAa,IAAI,CAAC,OAAO;gBAC9D;YACF;QACF;QAEA,IAAI,CAAC,MAAM,KAAK,IAAI,OAAO,MAAM,KAAK,KAAK,UAAU;YACnD,OAAO;gBACL,OAAO;gBACP,OAAO;oBACL,OAAO,CAAC,gCAAgC,EAAE,GAAG;oBAC7C,MAAM;gBACR;YACF;QACF;QAEA,IAAI,MAAM,IAAI,KAAK,aAAa,OAAO,MAAM,OAAO,KAAK,UAAU;YACjE,OAAO;gBACL,OAAO;gBACP,OAAO;oBACL,OAAO,CAAC,0CAA0C,EAAE,GAAG;oBACvD,MAAM;gBACR;YACF;QACF;QAEA,IAAI,MAAM,IAAI,KAAK,aAAa,CAAC,MAAM,OAAO,CAAC,MAAM,KAAK,GAAG;YAC3D,OAAO;gBACL,OAAO;gBACP,OAAO;oBACL,OAAO,CAAC,8CAA8C,EAAE,GAAG;oBAC3D,MAAM;gBACR;YACF;QACF;QAEA,IAAI,MAAM,IAAI,KAAK,aAAa,OAAO,MAAM,aAAa,KAAK,UAAU;YACvE,OAAO;gBACL,OAAO;gBACP,OAAO;oBACL,OAAO,CAAC,gDAAgD,EAAE,GAAG;oBAC7D,MAAM;gBACR;YACF;QACF;QAEA,IAAI,MAAM,IAAI,KAAK,cAAc;YAC/B,IAAI,OAAO,MAAM,WAAW,KAAK,YAAY,OAAO,MAAM,YAAY,KAAK,UAAU;gBACnF,OAAO;oBACL,OAAO;oBACP,OAAO;wBACL,OAAO,CAAC,iEAAiE,EAAE,GAAG;wBAC9E,MAAM;oBACR;gBACF;YACF;QACF;QAEA,IAAI,MAAM,IAAI,KAAK,WAAW,OAAO,MAAM,WAAW,KAAK,UAAU;YACnE,OAAO;gBACL,OAAO;gBACP,OAAO;oBACL,OAAO,CAAC,4CAA4C,EAAE,GAAG;oBACzD,MAAM;gBACR;YACF;QACF;IACF;IAEA,OAAO;QAAE,OAAO;QAAM,MAAM;IAAsC;AACpE;AAMO,eAAe,KAAK,OAAoB;IAC7C,IAAI;QACF,MAAM,gBAAgB,QAAQ,OAAO,CAAC,GAAG,CAAC;QAC1C,IAAI,iBAAiB,OAAO,QAAQ,CAAC,iBAAiB,kBAAkB;YACtE,OAAO,gJAAY,CAAC,IAAI,CACtB;gBACE,OAAO;gBACP,MAAM;gBACN,SAAS,CAAC,wBAAwB,EAAE,mBAAmB,OAAO,KAAK,EAAE,CAAC;YACxE,GACA;gBAAE,QAAQ;YAAI;QAElB;QAEA,IAAI;QACJ,IAAI;YACF,OAAO,MAAM,QAAQ,IAAI;QAC3B,EAAE,OAAM;YACN,OAAO,gJAAY,CAAC,IAAI,CACtB;gBACE,OAAO;gBACP,MAAM;gBACN,SAAS;YACX,GACA;gBAAE,QAAQ;YAAI;QAElB;QAEA,IAAI,eAAe;YACjB,MAAM,SAAS,AAAC,MAAkC,UAAU,QAAQ,OAAO,CAAC,GAAG,CAAC;YAChF,IAAI,WAAW,eAAe;gBAC5B,OAAO,gJAAY,CAAC,IAAI,CACtB;oBACE,OAAO;oBACP,MAAM;oBACN,SAAS;gBACX,GACA;oBAAE,QAAQ;gBAAI;YAElB;QACF;QAEA,MAAM,aAAa,gBAAgB;QACnC,IAAI,CAAC,WAAW,KAAK,EAAE;YACrB,OAAO,gJAAY,CAAC,IAAI,CAAC,WAAW,KAAK,EAAE;gBAAE,QAAQ;YAAI;QAC3D;QAEA,MAAM,EAAE,KAAK,EAAE,MAAM,EAAE,GAAG,WAAW,IAAI;QAEzC,MAAM,OAAO,IAAI,+JAAS;QAC1B,KAAK,KAAK,GAAG;QACb,KAAK,MAAM,GAAG;QACd,KAAK,OAAO,GAAG;QACf,KAAK,MAAM,GAAG;QAEd,mBAAmB;QAEnB,IAAI,cAAc;QAClB,KAAK,MAAM,SAAS,OAAQ;YAC1B,OAAQ,MAAM,IAAI;gBAChB,KAAK;oBACH,MAAM,cAAc,MAAM;oBAC1B;gBACF,KAAK;oBACH,MAAM,gBAAgB,MAAM;oBAC5B;gBACF,KAAK;oBACH,MAAM,gBAAgB,MAAM,OAAO,OAAO;oBAC1C;gBACF,KAAK;oBACH,MAAM,gBAAgB,MAAM,OAAO,OAAO;oBAC1C;gBACF,KAAK;oBACH,MAAM,kBAAkB,MAAM,OAAO,OAAO;oBAC5C;gBACF,KAAK;oBACH,MAAM,cAAc,MAAM,OAAO,OAAO;oBACxC;YACJ;YACA;QACF;QAEA,MAAM,aAAa,MAAM,KAAK,KAAK,CAAC;YAAE,YAAY;QAAS;QAC3D,MAAM,YAAY,MAAM,OAAO,CAAC,iBAAiB,KAAK,SAAS,CAAC,GAAG;QACnE,MAAM,WAAW,GAAG,UAAU,CAAC,EAAE,KAAK,GAAG,GAAG,KAAK,CAAC;QAElD,OAAO,gJAAY,CAAC,IAAI,CAAC;YACvB;YACA,YAAY;QACd;IACF,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,yBAAyB;QACvC,OAAO,gJAAY,CAAC,IAAI,CACtB;YACE,OAAO;YACP,MAAM;YACN,SAAS,iBAAiB,QAAQ,MAAM,OAAO,GAAG;QACpD,GACA;YAAE,QAAQ;QAAI;IAElB;AACF"}}]
}